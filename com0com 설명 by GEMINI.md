com0com 설정 및 사용 설명 💻
com0com은 Windows 환경에서 가상의 직렬 COM 포트 쌍을 생성해주는 무료 오픈 소스 소프트웨어입니다. 시리얼 통신 장비(RS-232/422/485) 시뮬레이터를 개발하거나 테스트할 때, 실제 하드웨어 포트나 케이블 없이도 응용 프로그램(Client)과 시뮬레이터(Server)가 통신할 수 있도록 연결 통로를 제공하는 데 필수적입니다.

1. com0com의 원리 및 역할
com0com은 널 모뎀(Null Modem) 케이블과 동일한 역할을 소프트웨어적으로 수행합니다.

원리: 두 개의 가상 COM 포트를 **쌍(Pair)**으로 묶습니다. 한쪽 포트(예: COM5)로 데이터를 전송하면, 그 데이터는 즉시 다른 쪽 포트(예: COM6)로 수신됩니다.

활용:

시뮬레이터 (Server): 가상 포트 중 하나(예: COM5)를 열고 통신 요청을 기다립니다.

응용 프로그램 (Client): 다른 쪽 포트(예: COM6)를 열고 시뮬레이터로 통신 요청을 보냅니다.

이를 통해 하나의 PC에서 두 프로그램이 가상의 직렬 통신을 수행할 수 있습니다.

2. com0com 설정 단계
1. 설치 및 드라이버 서명 확인
다운로드: com0com 공식 웹사이트에서 설치 파일을 다운로드하고 실행합니다.

설치 옵션: 특별한 설정 없이 기본값으로 진행합니다.

드라이버 서명 문제 (주의): Windows 10/11에서는 디지털 서명이 없는 드라이버 설치가 기본적으로 차단될 수 있습니다. 설치 중 문제가 발생하거나 포트가 인식되지 않으면, **테스트 모드(Test Mode)**나 드라이버 서명 적용 사용 안 함 모드로 Windows를 재시작해야 할 수 있습니다.

2. 가상 포트 쌍 생성 및 관리
설치가 완료되면 Setup Command Prompt 또는 Setup 애플리케이션을 실행하여 포트를 관리합니다.

초기 설정 확인: 기본적으로 CNCA0와 CNCB0라는 이름의 한 쌍의 가상 포트가 생성됩니다. Windows 장치 관리자에서는 이 포트들이 COMx 형태로 할당됩니다 (예: COM5, COM6).

포트 이름 지정 (옵션): 응용 프로그램에서 사용하기 편하도록 포트 이름을 변경할 수 있습니다.

Setup Command Prompt에서 다음 명령을 사용합니다:

Bash

install PortName=COM10 PortName=COM11
이 명령은 COM10과 COM11 한 쌍을 새로 생성하고 연결합니다.

포트 삭제: 더 이상 사용하지 않는 가상 포트 쌍은 다음 명령으로 제거할 수 있습니다.

Bash

uninstall COMx COMz
확인: Windows 장치 관리자 → 포트 (COM 및 LPT) 항목에서 새로 생성된 가상 포트 쌍이 정상적으로 등록되었는지 확인합니다.

3. 시뮬레이터와 응용 프로그램 연결
가상 포트 쌍을 생성했다면, 이제 이를 시뮬레이터와 응용 프로그램에 할당합니다.

역할	할당 포트 예시	프로그램 동작
시뮬레이터 (Server)	COM10	COM10을 열고 데이터를 읽기 위해 대기합니다. 응용 프로그램이 보낸 요청을 수신하고, 처리 후 응답을 COM10으로 씁니다.
응용 프로그램 (Client)	COM11	COM11을 열고 통신을 시작합니다. 시뮬레이터로 요청을 보내고, 시뮬레이터의 응답을 COM11로 읽습니다.

Sheets로 내보내기

이러한 설정은 실제 물리적인 RS-232 통신과 완전히 동일하게 작동하므로, 제어 프로그램 개발자는 COM11이 실제 저울이나 PLC라고 가정하고 개발을 진행할 수 있습니다.